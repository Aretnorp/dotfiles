from newco.models import DBSession
from newco.models import EventPlanner

from newco.forms.formEventPlanner import schema

from deform import Form


def my_view(request):
    # Open database session
    dbsession = DBSession()
    form = Form(schema, buttons=('submit',))

    # Form was submitted
    if 'submit' in request.POST:
        # Get the list of controls
        controls = request.POST.items()

        # Validate the form
        try:
            appstruct = form.validate(controls)
        except ValidationFailure, e: # Catch if it doesn't work
            renderedform = e.render()
    else:
        renderedform = form.render()

    # Render the page
    return {'root':'root', 'project':'NewCo',
            'form':renderedform}
